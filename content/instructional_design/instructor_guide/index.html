<html>

<head>
<meta name=Title content="">
<meta name=Keywords content="">
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Arial;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Courier New";
	panose-1:2 7 3 9 2 2 5 2 4 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Arial Bold";}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
h1
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	page-break-before:always;
	font-size:18.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
h2
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:51.3pt;
	text-indent:-.4in;
	font-size:16.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
h3
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	text-indent:-.5in;
	font-size:14.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
h4
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.6in;
	text-indent:-.6in;
	font-size:12.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
h5
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.7in;
	text-indent:-.7in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
h6
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.8in;
	text-indent:-.8in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.9in;
	text-indent:-.9in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	text-align:right;
	text-indent:-1.0in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.1in;
	text-align:center;
	text-indent:-1.1in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	color:navy;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:12.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:24.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex3, li.MsoIndex3, div.MsoIndex3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex4, li.MsoIndex4, div.MsoIndex4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:48.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex5, li.MsoIndex5, div.MsoIndex5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:60.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex6, li.MsoIndex6, div.MsoIndex6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.0in;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex7, li.MsoIndex7, div.MsoIndex7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:84.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex8, li.MsoIndex8, div.MsoIndex8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:96.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoIndex9, li.MsoIndex9, div.MsoIndex9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.5in;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	text-transform:uppercase;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-variant:small-caps;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	line-height:15.0pt;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:right;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	color:navy;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	color:navy;}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	font-weight:bold;}
p.MsoTof, li.MsoTof, div.MsoTof
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoToa, li.MsoToa, div.MsoToa
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:12.0pt;
	text-indent:-12.0pt;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoMacroText, li.MsoMacroText, div.MsoMacroText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:9.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Courier New",serif;}
p.MsoToaHeading, li.MsoToaHeading, div.MsoToaHeading
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListBullet3, li.MsoListBullet3, div.MsoListBullet3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListBullet4, li.MsoListBullet4, div.MsoListBullet4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.0in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListBullet5, li.MsoListBullet5, div.MsoListBullet5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.25in;
	text-indent:-.25in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListNumber2, li.MsoListNumber2, div.MsoListNumber2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListNumber3, li.MsoListNumber3, div.MsoListNumber3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	font-size:36.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListContinue, li.MsoListContinue, div.MsoListContinue
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:17.85pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListContinue2, li.MsoListContinue2, div.MsoListContinue2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListContinue3, li.MsoListContinue3, div.MsoListContinue3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.75in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListContinue4, li.MsoListContinue4, div.MsoListContinue4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.75in;
	text-indent:.25in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.MsoListContinue5, li.MsoListContinue5, div.MsoListContinue5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.25in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	background:navy;
	font-size:11.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Courier New",serif;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:8.0pt;
	font-family:"Tahoma",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	line-height:15.0pt;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	text-align:center;
	font-size:16.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading1Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading2Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading3Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading4Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading5Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading6Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading7Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading8Char
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.Heading9Char
	{font-family:"Arial",sans-serif;
	color:navy;}
span.BodyTextChar
	{font-family:"Arial",sans-serif;}
span.HeaderChar
	{font-family:"Arial",sans-serif;
	color:navy;}
p.FigCaption, li.FigCaption, div.FigCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:9.0pt;
	font-family:"Arial",sans-serif;
	font-style:italic;}
p.NoteHeader, li.NoteHeader, div.NoteHeader
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
p.Note, li.Note, div.Note
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
span.NoteChar
	{font-family:"Arial",sans-serif;}
span.NoteHeaderChar
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.FooterChar
	{font-family:"Arial",sans-serif;
	color:navy;}
p.SubTitle, li.SubTitle, div.SubTitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	font-size:20.0pt;
	font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
span.TitleChar
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:bold;}
p.NormalLegal, li.NormalLegal, div.NormalLegal
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:13.6pt;
	margin-bottom:.0001pt;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.TableLeft, li.TableLeft, div.TableLeft
	{margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
span.CommentTextChar
	{font-family:"Arial",sans-serif;}
span.DocumentMapChar
	{font-family:"Tahoma",sans-serif;
	background:transparent;}
span.EndnoteTextChar
	{font-family:"Arial",sans-serif;}
span.FootnoteTextChar
	{font-family:"Arial",sans-serif;}
span.MacroTextChar
	{font-family:"Courier New",serif;}
span.PlainTextChar
	{font-family:"Courier New",serif;}
span.BalloonTextChar
	{font-family:"Tahoma",sans-serif;}
p.Table, li.Table, div.Table
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
span.TableChar
	{font-family:"Arial",sans-serif;}
p.Code, li.Code, div.Code
	{margin-top:3.0pt;
	margin-right:7.35pt;
	margin-bottom:3.0pt;
	margin-left:0in;
	background:#DDDDDD;
	font-size:10.0pt;
	font-family:"Courier New",serif;}
span.CodeChar
	{font-family:"Courier New",serif;
	background:transparent;}
p.Parameters, li.Parameters, div.Parameters
	{margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:140%;
	font-size:10.0pt;
	font-family:"Verdana",sans-serif;
	font-style:italic;}
span.ParametersChar
	{font-family:"Verdana",sans-serif;
	font-style:italic;}
span.CommentSubjectChar
	{font-family:"Arial",sans-serif;
	font-weight:bold;}
p.Figure, li.Figure, div.Figure
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.FigureLarge, li.FigureLarge, div.FigureLarge
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial",sans-serif;}
p.To, li.To, div.To
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	font-weight:bold;}
p.TableCaption, li.TableCaption, div.TableCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	line-height:15.0pt;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	font-weight:bold;}
p.TableHeading, li.TableHeading, div.TableHeading
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	font-weight:bold;}
p.TemplateComment, li.TemplateComment, div.TemplateComment
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial Bold",sans-serif;
	color:red;
	font-weight:bold;}
span.BodyBold
	{font-family:"Arial Bold",sans-serif;
	color:windowtext;
	font-weight:bold;
	text-decoration:none none;
	vertical-align:baseline;}
span.refs
	{font-family:"Arial Bold",sans-serif;
	color:navy;
	font-weight:normal;
	text-decoration:underline none underline;
	vertical-align:baseline;}
.MsoChpDefault
	{font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
 /* Page Definitions */
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:1.0in .8in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:1.0in .8in 1.0in 1.0in;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:1.0in .8in 1.0in 1.0in;}
div.WordSection3
	{page:WordSection3;}
@page WordSection4
	{size:595.3pt 841.9pt;
	margin:1.3in .8in 1.0in 1.0in;}
div.WordSection4
	{page:WordSection4;}
 /* List Definitions */
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink="#954F72">

<div class=WordSection1>

<p class=MsoTitle>&nbsp;</p>

<p class=MsoTitle><img width=211 height=87 id="_x0000_i1038"
src="dbMotion%20Instructor%20Guide.fld/image001.png" alt="dbMlog_Trgb"></p>

<p class=MsoTitle>&nbsp;</p>

<p class=MsoTitle>dbMotion Instructor Guide </p>

<p class=SubTitle>Course 2</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

</div>

<span style='font-size:10.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:left'>
</span>

<div class=WordSection2>

<p class=MsoTocHeading>Document Control</p>

<p class=MsoBodyText>&nbsp;</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=462
 style='width:461.55pt;margin-left:10.75pt;border-collapse:collapse;border:
 none'>
 <thead>
  <tr>
   <td width=54 valign=top style='width:54.3pt;border:solid navy 1.0pt;
   background:#E5E5E5;padding:0in 5.4pt 0in 5.4pt'>
   <p class=TableHeading>Date</p>
   </td>
   <td width=72 valign=top style='width:72.4pt;border:solid navy 1.0pt;
   border-left:none;background:#E5E5E5;padding:0in 5.4pt 0in 5.4pt'>
   <p class=TableHeading>Release No.</p>
   </td>
   <td width=85 valign=top style='width:85.15pt;border:solid navy 1.0pt;
   border-left:none;background:#E5E5E5;padding:0in 5.4pt 0in 5.4pt'>
   <p class=TableHeading>Author</p>
   </td>
   <td width=100 valign=top style='width:99.55pt;border:solid navy 1.0pt;
   border-left:none;background:#E5E5E5;padding:0in 5.4pt 0in 5.4pt'>
   <p class=TableHeading>Reviewed by</p>
   </td>
   <td width=150 valign=top style='width:150.15pt;border:solid navy 1.0pt;
   border-left:none;background:#E5E5E5;padding:0in 5.4pt 0in 5.4pt'>
   <p class=TableHeading>Comments</p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=54 valign=top style='width:54.3pt;border:solid navy 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>17/05/10</p>
  </td>
  <td width=72 valign=top style='width:72.4pt;border-top:none;border-left:none;
  border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>Release 1.0</p>
  </td>
  <td width=85 valign=top style='width:85.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>Doron podlovski</p>
  </td>
  <td width=100 valign=top style='width:99.55pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=150 valign=top style='width:150.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>First draft</p>
  </td>
 </tr>
 <tr>
  <td width=54 valign=top style='width:54.3pt;border:solid navy 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>16/07/17</p>
  </td>
  <td width=72 valign=top style='width:72.4pt;border-top:none;border-left:none;
  border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>Release 2.0</p>
  </td>
  <td width=85 valign=top style='width:85.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>Adam Verdin</p>
  </td>
  <td width=100 valign=top style='width:99.55pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>Adam Verdin</p>
  </td>
  <td width=150 valign=top style='width:150.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>Second Draft- Instructor Guide</p>
  </td>
 </tr>
 <tr>
  <td width=54 valign=top style='width:54.3pt;border:solid navy 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=72 valign=top style='width:72.4pt;border-top:none;border-left:none;
  border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=85 valign=top style='width:85.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=100 valign=top style='width:99.55pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=150 valign=top style='width:150.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=54 valign=top style='width:54.3pt;border:solid navy 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=72 valign=top style='width:72.4pt;border-top:none;border-left:none;
  border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=85 valign=top style='width:85.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=100 valign=top style='width:99.55pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
  <td width=150 valign=top style='width:150.15pt;border-top:none;border-left:
  none;border-bottom:solid navy 1.0pt;border-right:solid navy 1.0pt;padding:
  0in 5.4pt 0in 5.4pt'>
  <p class=Table>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

</div>

<span class=refs><span style='font-size:10.0pt'><br clear=all style='page-break-before:
always'>
</span></span>

<div class=WordSection3>

<p class=MsoTocHeading>Table of Contents</p>

<p class=MsoToc1><a href="#_Toc262116633">1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;text-transform:none;
font-weight:normal;text-decoration:none'>         </span>Introduction<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc262116634">1.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;font-variant:normal !important;color:windowtext;
text-decoration:none'>           </span>Setting up a SDK solution<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc3><a href="#_Toc262116635">1.1.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>System Requirements<span style='color:windowtext;display:
none;text-decoration:none'>. </span><span style='color:windowtext;display:none;
text-decoration:none'>3</span></a></p>

<p class=MsoToc3><a href="#_Toc262116636">1.1.2<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Adding the application server certification<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoToc3><a href="#_Toc262116637">1.1.3<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Creating a visual studio solution for dbMotion SDK<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>7</span></a></p>

<p class=MsoToc1><a href="#_Toc262116638">2<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;text-transform:none;
font-weight:normal;text-decoration:none'>         </span>Using the SDK<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></p>

<p class=MsoToc2><a href="#_Toc262116639">2.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;font-variant:normal !important;color:windowtext;
text-decoration:none'>           </span>Setting a security principal<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>13</span></a></p>

<p class=MsoToc3><a href="#_Toc262116640">2.1.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Exercise<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span style='color:windowtext;display:none;
text-decoration:none'>13</span></a></p>

<p class=MsoToc2><a href="#_Toc262116641">2.2<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;font-variant:normal !important;color:windowtext;
text-decoration:none'>           </span>Getting information from the dbMotion
business layer<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></p>

<p class=MsoToc3><a href="#_Toc262116642">2.2.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Creating a business command<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span style='color:windowtext;
display:none;text-decoration:none'>15</span></a></p>

<p class=MsoToc3><a href="#_Toc262116643">2.2.2<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Connection to the business layer<span style='color:windowtext;
display:none;text-decoration:none'> </span><span style='color:windowtext;
display:none;text-decoration:none'>16</span></a></p>

<p class=MsoToc3><a href="#_Toc262116644">2.2.3<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>dbMotion business Command<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span style='color:windowtext;
display:none;text-decoration:none'>17</span></a></p>

<p class=MsoToc3><a href="#_Toc262116645">2.2.4<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Exercise<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span style='color:windowtext;display:none;
text-decoration:none'>18</span></a></p>

<p class=MsoToc2><a href="#_Toc262116646">2.3<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;font-variant:normal !important;color:windowtext;
text-decoration:none'>           </span>Using the VIA client<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></p>

<p class=MsoToc3><a href="#_Toc262116647">2.3.1<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Getting started<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span style='color:windowtext;display:none;
text-decoration:none'>19</span></a></p>

<p class=MsoToc3><a href="#_Toc262116648">2.3.2<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Searching for patients<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span style='color:windowtext;
display:none;text-decoration:none'>19</span></a></p>

<p class=MsoToc3><a href="#_Toc262116649">2.3.3<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;font-style:normal;text-decoration:
none'>      </span>Exercise<span style='color:windowtext;display:none;
text-decoration:none'>. </span><span style='color:windowtext;display:none;
text-decoration:none'>20</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<b><span style='font-size:16.0pt;font-family:"Arial Bold",sans-serif;
color:navy'><br clear=all style='page-break-before:always'>
</span></b>

<p class=MsoTocHeading>&nbsp;</p>

<p class=MsoTocHeading>List of Figures</p>

<p class=MsoTof><a href="#_Toc262113689">Figure 1 - Windows command run<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>3</span></a></p>

<p class=MsoTof><a href="#_Toc262113690">Figure 2 - Microsoft Management
Console<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoTof><a href="#_Toc262113691">Figure 3 - Snap-in list<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoTof><a href="#_Toc262113692">Figure 4 - Certificate type selection<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoTof><a href="#_Toc262113693">Figure 5 - Computer select<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></p>

<p class=MsoTof><a href="#_Toc262113694">Figure 6 - Certification manager<span
style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoTof><a href="#_Toc262113695">Figure 7 - Path to the CER file<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></p>

<p class=MsoTof><a href="#_Toc262113696">Figure 8 - Add new Item<span
style='color:windowtext;display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>7</span></a></p>

<p class=MsoTof><a href="#_Toc262113697">Figure 9 - Application configuration file<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>7</span></a></p>

<p class=MsoTof><a href="#_Toc262113698">Figure 10 - Add References<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoTof><a href="#_Toc262113699">Figure 11 – SDK References<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>11</span></a></p>

<p class=MsoTof><a href="#_Toc262113700">Figure 12 - minimum references
requirement<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>12</span></a></p>

<p class=MsoTof><a href="#_Toc262113701">Figure 13 - Additional references<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>19</span></a></p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

</div>

<span style='font-size:11.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:always'>
</span>

<div class=WordSection4>

<h1><a name="_Toc262116633">1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Introduction</a> </h1>

<p class=MsoBodyText>The dbMotion Client SDK presents developers with tools to
develop against dbMotion Core services, focusing mainly on how to search for
patients and retrieve clinical data.</p>

<h2><a name="OLE_LINK13"><a name="OLE_LINK12"><a name="_Toc262116634">1.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Setting up a SDK
solution</a></a></a></h2>

<p class=MsoBodyText>The following is required in order to start working with
the dbMotion SDK. </p>

<h3><a name="OLE_LINK2"><a name="OLE_LINK1"><a name="_Toc262116635">1.1.1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>System Requirements</a></a></a></h3>

<p class=MsoBodyText>The following software packages must be installed prior to
installing and using the dbMotion Client</p>

<p class=MsoBodyText>SDK:</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Windows XP Professional, Windows Server 2003, or
Windows Vista</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft .NET Framework 3.5</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft WSE 3.0</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Microsoft Visual Studio 2008 Standard or higher edition</p>

<h3><a name="_Toc262116636">1.1.2<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Adding the application server certification</a></h3>

<p class=MsoBodyText>For us to be able to communicate with the application
server we must add the certification of the server to our computer
certification list, to do so we will use the windows certification manager.</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>At your
desktop, enter Start <span style='font-family:"Wingdings 3"'>&quot;</span>
Run&nbsp;<span style='font-family:"Wingdings 3"'>&quot;</span> MMC</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=173
height=95 id="Picture 7" src="dbMotion%20Instructor%20Guide.fld/image002.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113689">Figure </a>1 - Windows command run</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Press “OK”</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>The MMC
will be open, Press on File <span style='font-family:"Wingdings 3"'>&quot;</span>
Add / remove Snap-in</p>

<p class=MsoBodyText style='margin-left:.5in'>&nbsp;</p>

<p class=MsoBodyText align=center style='margin-left:31.5pt;text-align:center'><img
width=428 height=202 id="_x0000_i1036"
src="dbMotion%20Instructor%20Guide.fld/image003.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113690">Figure </a>2 - Microsoft Management Console</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Press add,
from the appearing windows select “Certificates”</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=261
height=274 id="_x0000_i1035"
src="dbMotion%20Instructor%20Guide.fld/image004.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113691">Figure </a>3 - Snap-in list</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Press
“Add” and select the “computers” radio button:</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=309
height=231 id="_x0000_i1034"
src="dbMotion%20Instructor%20Guide.fld/image005.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113692">Figure </a>4 - Certificate type selection</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Press
“Next”</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
“Local computer” &nbsp;and press finish </p>

<p class=MsoBodyText align=center style='text-align:center'><img width=300
height=224 id="_x0000_i1033"
src="dbMotion%20Instructor%20Guide.fld/image006.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113693">Figure </a>5 - Computer select</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Press
“Close” and “OK”.</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Select
form the tree view “Personal” <span style='font-family:"Wingdings 3"'>&quot;</span>
“Certificates”</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Right Click the Viewer on
right hand side of the window, from the popup window select “All Tasks”<span
style='font-family:"Wingdings 3"'>&quot;</span> “Import”</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=447
height=232 id="_x0000_i1032"
src="dbMotion%20Instructor%20Guide.fld/image007.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113694">Figure </a>6 - Certification manager</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Enter a path to the relevant
*.CER file.</p>

<p class=MsoBodyText align=center style='margin-left:.5in;text-align:center'><img
width=267 height=211 id="Picture 4"
src="dbMotion%20Instructor%20Guide.fld/image008.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113695">Figure </a>7 - Path to the CER file</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>12.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Press “Next” </p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>13.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Press “Finish”</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>14.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Close the MMC. </p>

<span style='font-size:11.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<h3><a name="_Toc262116637">1.1.3<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Creating a visual studio solution for dbMotion SDK</a></h3>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Create an
empty .NET <a name="OLE_LINK5"><a name="OLE_LINK4"><a name="OLE_LINK3">solution
</a>(Console, windows form, ASP.NET).</a></a></p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'><span
style='font-family:Webdings'>i<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><b><i><u>Note</u></i></b>: for this hands on we will be using a
console application, all though the instruction fits to all above .NET
solutions.</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Add to the
new solution an application configuration file (App.config; Web.config)</p>

<p class=MsoBodyText style='margin-left:1.0in;text-indent:-.25in'><a
name="OLE_LINK7"><a name="OLE_LINK6"><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Right
click the project name in the project navigator bar and select: Add </a></a><span
style='font-family:"Wingdings 3"'>&quot;</span>  New item</p>

<p class=MsoBodyText align=center style='margin-left:1.0in;text-align:center'><img
width=307 height=247 id="Picture 8"
src="dbMotion%20Instructor%20Guide.fld/image009.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113696">Figure </a>8 - Add new Item</p>

<p class=MsoBodyText style='margin-left:.5in'>&nbsp;</p>

<p class=MsoBodyText style='margin-left:.5in'>&nbsp;</p>

<p class=MsoBodyText style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>From the appearing menu select the “Application Configuration
File” </p>

<p class=MsoBodyText align=center style='margin-left:.5in;text-align:center'><img
width=307 height=189 id="Picture 9"
src="dbMotion%20Instructor%20Guide.fld/image010.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113697">Figure </a>9 - Application configuration file</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Add the following sections to the new configuration file you have
created:</p>

<p class=Code>&lt;?xml version=&quot;1.0&quot;?&gt;</p>

<p class=Code>&lt;configuration&gt;</p>

<p class=Code>  &lt;configSections&gt;</p>

<p class=Code>    &lt;sectionGroup name=&quot;security&quot;
type=&quot;dbMotion.Security.Configuration.SecuritySectionGroup,
dbMotion.Security, Version=3.0.0.0,
Culture=neutral,PublicKeyToken=85aefa0259d3383e&quot;&gt;</p>

<p class=Code>      &lt;section name=&quot;identity&quot;
type=&quot;dbMotion.Security.Configuration.IdentitySection, dbMotion.Security,
Version=3.0.0.0, Culture=neutral,PublicKeyToken=85aefa0259d3383e&quot; /&gt;</p>

<p class=Code>      &lt;section name=&quot;credentialSets&quot;
type=&quot;dbMotion.Security.Configuration.CredentialSetsSection,
dbMotion.Security, Version=3.0.0.0,
Culture=neutral,PublicKeyToken=85aefa0259d3383e&quot; /&gt;</p>

<p class=Code>      &lt;section name=&quot;soapClients&quot;
type=&quot;dbMotion.Security.Configuration.SoapClientsSection,
dbMotion.Security, Version=3.0.0.0,
Culture=neutral,PublicKeyToken=85aefa0259d3383e&quot; /&gt;</p>

<p class=Code>    &lt;/sectionGroup&gt;</p>

<p class=Code>  &lt;/configSections&gt;</p>

<p class=Code>  &lt;appSettings&gt;    </p>

<p class=Code>    &lt;add key=&quot;BusinessAccessService&quot;
value=&quot;net.tcp://<b><span style='background:lime'>[Application Server
name]</span></b>:8081/dbMotion/BusinessAccessService&quot; /&gt;</p>

<p class=Code>  &lt;/appSettings&gt;</p>

<p class=Code>  &lt;security&gt;</p>

<p class=Code>    &lt;identity
principalDelegationMode=&quot;DelegateCurrentPrincipal&quot; /&gt;</p>

<p class=Code>    &lt;credentialSets&gt;</p>

<p class=Code>      &lt;add name=&quot;dbMotionBusinessClientTool&quot;
mode=&quot;ActiveDirectory&quot;&gt;</p>

<p class=Code>        &lt;activeDirectory
userName=&quot;dbvDataAccessUser&quot; password=&quot;1qaz@@wsx&quot;/&gt;</p>

<p class=Code>      &lt;/add&gt;</p>

<p class=Code>    &lt;/credentialSets&gt;</p>

<p class=Code>    &lt;soapClients&gt;</p>

<p class=Code>      &lt;securityAuthority uri=&quot;soap.tcp://<b><span
style='background:lime'>[<a name="OLE_LINK9"><a name="OLE_LINK8">Security </a>server
name]</a></span></b>:9000/SecurityAuthorityService&quot; /&gt;</p>

<p class=Code>    &lt;/soapClients&gt;</p>

<p class=Code>  &lt;/security&gt;     </p>

<p class=Code>  &lt;system.serviceModel&gt;</p>

<p class=Code>    &lt;extensions&gt;</p>

<p class=Code>      &lt;behaviorExtensions&gt;</p>

<p class=Code>        &lt;add name=&quot;dbMotionContext&quot;
type=&quot;dbMotion.DbmSystem.ServiceModel.Contexts.Configuration.DbmContextEndpointBehaviorExtensionElement,
dbMotion.DbmSystem, Version=3.0.0.0, Culture=neutral,
PublicKeyToken=85aefa0259d3383e&quot; /&gt;</p>

<p class=Code>      &lt;/behaviorExtensions&gt;</p>

<p class=Code>    &lt;/extensions&gt;</p>

<p class=Code>    &lt;bindings&gt;</p>

<p class=Code>      &lt;netNamedPipeBinding&gt;</p>

<p class=Code>        &lt;binding name=&quot;netPipeBusinessMessage&quot; closeTimeout=&quot;00:00:10&quot;
openTimeout=&quot;00:00:10&quot; maxConnections=&quot;100&quot;
maxReceivedMessageSize=&quot;10000000&quot;&gt;</p>

<p class=Code>          &lt;readerQuotas
maxStringContentLength=&quot;10000000&quot; maxArrayLength=&quot;10000000&quot;
/&gt;</p>

<p class=Code>          &lt;security mode=&quot;None&quot; /&gt;</p>

<p class=Code>        &lt;/binding&gt;</p>

<p class=Code>      &lt;/netNamedPipeBinding&gt;</p>

<p class=Code>      &lt;netTcpBinding&gt;</p>

<p class=Code>        &lt;binding name=&quot;netTcpBusinessMessage&quot;
closeTimeout=&quot;00:00:10&quot; openTimeout=&quot;00:00:10&quot;
maxConnections=&quot;100&quot; maxReceivedMessageSize=&quot;10000000&quot;&gt;</p>

<p class=Code>          &lt;readerQuotas
maxStringContentLength=&quot;10000000&quot; maxArrayLength=&quot;10000000&quot;
/&gt;</p>

<p class=Code>          &lt;security mode=&quot;None&quot; /&gt;</p>

<p class=Code>        &lt;/binding&gt;</p>

<p class=Code>      &lt;/netTcpBinding&gt;</p>

<p class=Code>      &lt;wsHttpBinding&gt;</p>

<p class=Code>        &lt;binding name=&quot;wsHttpBusinessMessage&quot;
closeTimeout=&quot;00:00:10&quot; openTimeout=&quot;00:00:10&quot;
maxReceivedMessageSize=&quot;10000000&quot;&gt;</p>

<p class=Code>          &lt;readerQuotas
maxStringContentLength=&quot;10000000&quot; maxArrayLength=&quot;10000000&quot;
/&gt;</p>

<p class=Code>          &lt;security mode=&quot;None&quot; /&gt;</p>

<p class=Code>        &lt;/binding&gt;</p>

<p class=Code>      &lt;/wsHttpBinding&gt;</p>

<p class=Code>    &lt;/bindings&gt;</p>

<p class=Code>    &lt;behaviors&gt;</p>

<p class=Code>      &lt;endpointBehaviors&gt;</p>

<p class=Code>        &lt;behavior
name=&quot;dbMotionBusinessServiceBehaviour&quot;&gt;</p>

<p class=Code>          &lt;dbMotionContext /&gt;</p>

<p class=Code>        &lt;/behavior&gt;</p>

<p class=Code>      &lt;/endpointBehaviors&gt;</p>

<p class=Code>    &lt;/behaviors&gt;</p>

<p class=Code>    &lt;client&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;netNamedPipeBinding&quot;
bindingConfiguration=&quot;netPipeBusinessMessage&quot; contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;net.pipeBusinessMetadataServiceClient&quot; /&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;netTcpBinding&quot;
bindingConfiguration=&quot;netTcpBusinessMessage&quot;
contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;net.tcpBusinessMetadataServiceClient&quot; /&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;wsHttpBinding&quot;
bindingConfiguration=&quot;wsHttpBusinessMessage&quot;
contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;httpBusinessMetadataServiceClient&quot; /&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;netNamedPipeBinding&quot;
bindingConfiguration=&quot;netPipeBusinessMessage&quot;
behaviorConfiguration=&quot;dbMotionBusinessServiceBehaviour&quot;
contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;net.pipeBusinessNetPipeServiceClient&quot; /&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;netTcpBinding&quot; bindingConfiguration=&quot;netTcpBusinessMessage&quot;
behaviorConfiguration=&quot;dbMotionBusinessServiceBehaviour&quot;
contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;net.tcpBusinessNetPipeServiceClient&quot; /&gt;</p>

<p class=Code>      &lt;endpoint binding=&quot;wsHttpBinding&quot;
bindingConfiguration=&quot;wsHttpBusinessMessage&quot;
behaviorConfiguration=&quot;dbMotionBusinessServiceBehaviour&quot;
contract=&quot;dbMotion.DbmSystem.ServiceModel.IDbmService&quot;
name=&quot;httpBusinessNetPipeServiceClient&quot; /&gt;</p>

<p class=Code>    &lt;/client&gt;</p>

<p class=Code>  &lt;/system.serviceModel&gt;</p>

<p class=Code>&lt;/configuration&gt;</p>

<h4 style='margin-left:.25in;text-indent:-.25in'><span style='font-size:10.0pt;
font-family:Webdings;color:windowtext;font-weight:normal'>i<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><u><span
style='font-size:10.0pt;font-family:"Arial",sans-serif;color:windowtext'>Note:</span></u><span
style='font-size:10.0pt;font-family:"Arial",sans-serif;color:windowtext;
font-weight:normal'> The highlighted field is the code above need to be
replaced by the relevant server name that holds the services needed.</span></h4>

<h4 style='margin-left:.25in;text-indent:-.25in'><span style='font-size:10.0pt;
font-family:Webdings;color:windowtext;font-weight:normal'>i<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><u><span
style='font-size:10.0pt;font-family:"Arial",sans-serif;color:windowtext'>Note:</span></u><span
style='font-size:10.0pt;font-family:"Arial",sans-serif;color:windowtext;
font-weight:normal'> This configuration section are a must, this section sets
the application to work with the relevant information servers (Such as
application server), sets the system relevant information (Such as system service
Model, dbMotion Security service etc).<br>
<br>
</span></h4>

<span style='font-size:11.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Adding
relevant References to the solution:</p>

<p class=MsoBodyText align=center style='margin-left:1.0in;text-align:center;
text-indent:-.25in'><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Right click the project name in the project navigator bar and
select: Add References<br>
<br>
<img width=266 height=320 id="Picture 15"
src="dbMotion%20Instructor%20Guide.fld/image011.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113698">Figure </a>10 - Add References</p>

<p class=MsoBodyText style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Set the path to the SDK installing folder i.e. “C:\Program
Files\dbMotion\Developer SDK\Binaries”.</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=253
height=211 id="Picture 16" src="dbMotion%20Instructor%20Guide.fld/image012.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113699">Figure </a>11 – SDK <a name="OLE_LINK11"><a
name="OLE_LINK10">References</a></a></p>

<p class=MsoBodyText style='margin-left:1.0in'>&nbsp;</p>

<p class=MsoBodyText style='margin-left:1.0in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The SDK references are divided to groups (folders). We will add
only the relevant binaries to our solution.</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=185
height=72 id="Picture 19" src="dbMotion%20Instructor%20Guide.fld/image013.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113700">Figure </a>12 - minimum references requirement</p>

<p class=MsoBodyText>To start using the SDK the initial class will be something
like this:</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Collections.Generic;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Linq;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Xml;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Text;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Data;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Security;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.Security.Authentication; </p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
System.IO;</p>

<p class=Code style='margin-right:2.2pt'>&nbsp;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
dbMotion.DbmSystem.BAC; </p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
dbMotion.Security;<span style='color:green'> </span></p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
dbMotion.Security.Authorization;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>using</span>
dbMotion.Security.Authentication;</p>

<p class=Code style='margin-right:2.2pt'>&nbsp;</p>

<p class=Code style='margin-right:2.2pt'><span style='color:blue'>namespace</span>
SDKHandsOn</p>

<p class=Code style='margin-right:2.2pt'>{</p>

<p class=Code style='margin-right:2.2pt'>    <span style='color:blue'>class</span>
Program</p>

<p class=Code style='margin-right:2.2pt'>    {</p>

<p class=Code style='margin-right:2.2pt'>        <span style='color:blue'>static</span>
<span style='color:blue'>void</span> Main(string[] args)</p>

<p class=Code style='margin-right:2.2pt'>        {            </p>

<p class=Code style='margin-right:2.2pt'>          <span style='color:green'>//
Your code </span></p>

<p class=Code style='margin-right:2.2pt'>        }</p>

<p class=Code style='margin-right:2.2pt'>    }</p>

<p class=Code style='margin-right:2.2pt'>}</p>

<p class=MsoBodyText>&nbsp;</p>

<h1><a name="_Toc262116638">2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Using the SDK</a> </h1>

<h2><a name="OLE_LINK21"><a name="OLE_LINK20"><a name="_Toc262116639">2.1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Setting a
security <a name="OLE_LINK15"></a></a></a></a><a name="OLE_LINK14">principal  </a></h2>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>The security
principal is a dbMotion object that defines all of the user rights within the
dbMotion system. Without the a security principal it`s imposable to work with
the system!</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>To create
a security principal we first have to <a name="OLE_LINK17"><a name="OLE_LINK16">authenticate
</a>our user under the systems (Active directory, SQL, etc):</a></p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>ActiveDirectoryAuthenticationRequest</span>
adRequest =</p>

<p class=Code style='margin-left:.5in'><span style='color:blue'>new</span> <span
style='color:#2B91AF'>ActiveDirectoryAuthenticationRequest</span>(<span
style='color:#A31515'>&quot;UserName&quot;</span>, <span style='color:#A31515'>&quot;Password&quot;</span>);</p>

<p class=Code style='margin-left:.5in'><span style='color:green'>// creating
the requests list</span></p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>List</span>&lt;AuthenticationRequest&gt;
requestList =</p>

<p class=Code style='margin-left:.5in'><span style='color:blue'>new</span> <span
style='color:#2B91AF'>List</span>&lt;AuthenticationRequest&gt;();</p>

<p class=Code style='margin-left:.5in'>requestList.Add(adRequest);</p>

<p class=MsoBodyText style='margin-left:.5in'>The code above is using an
ActiveDirectory authentication Request object, we can use the &quot;SQL Authentication
Request” object just the same.</p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>SqlAuthenticationRequest</span>
sqlRequest = <span style='color:blue'>new</span> <span style='color:#2B91AF'>SqlAuthenticationRequest</span>
(<span style='color:#A31515'>&quot;UserName&quot;</span>, <span
style='color:#A31515'>&quot;Password&quot;</span>);</p>

<p class=Code style='margin-left:.5in'><span style='color:green'>// creating
the requests list</span></p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>List</span>&lt;AuthenticationRequest&gt;
requestList =</p>

<p class=Code style='margin-left:.5in'><span style='color:blue'>new</span> <span
style='color:#2B91AF'>List</span>&lt;AuthenticationRequest&gt;();</p>

<p class=Code style='margin-left:.5in'>requestList.Add(adRequest);</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>After the
user has been authenticate, we need to create a user principal</p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>DbmPrincipal</span>
principal =            <span style='color:#2B91AF'>DbmSecurityManager</span>.ServiceSoapClient.AuthenticateUser(requestList);</p>

<p class=MsoBodyText style='margin-left:.5in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>The next
step is to make it our current session principal</p>

<p class=Code style='margin-left:.5in'>dbMotion.Security.<span
style='color:#2B91AF'>DbmSecurityManager</span>.CurrentPrincipal = principal;</p>

<p class=MsoBodyText style='margin-left:.5in'>Or, when using a Web project:</p>

<p class=Code style='margin-left:.5in'><span style='color:#2B91AF'>HttpContext</span>.Current.Session[SessionName]
= principal;</p>

<p class=MsoBodyText style='margin-left:.5in'>&nbsp;</p>

<h3><a name="OLE_LINK19"><a name="OLE_LINK18"><a name="_Toc262116640">2.1.1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Exercise</a></a></a></h3>

<p class=MsoBodyText>Create a simple client that authenticates to the dbMotion
system and greets the user after a successful login.</p>

<p class=MsoBodyText style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Webdings'>i<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><u>Note:</u><b> </b>Try to write it yourself and use this sample
as a reference. </p>

<p class=Code><a name="OLE_LINK41"><a name="OLE_LINK40"><span style='color:
green'>// Exercise 2.1.1 </span></a></a></p>

<p class=Code><span style='color:blue'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>public</span> <span style='color:blue'>static</span>
<span style='color:blue'>bool</span> Authenticating(<span style='color:blue'>string</span>
userName,<span style='color:blue'>string</span> password)</p>

<p class=Code>{</p>

<p class=Code><span style='color:#2B91AF'>        ActiveDirectoryAuthenticationRequest</span>
adRequest = <span style='color:blue'>new</span> </p>

<p class=Code>        <span style='color:#2B91AF'>ActiveDirectoryAuthenticationRequest</span>(userName,
password);</p>

<p class=Code><span style='color:blue'>        if</span> (adRequest != <span
style='color:blue'>null</span>)</p>

<p class=Code>        {</p>

<p class=Code><span style='color:green'>               // creating the requests
list</span></p>

<p class=Code><span style='color:#2B91AF'>               List</span>&lt;<span
style='color:#2B91AF'>AuthenticationRequest</span>&gt; requestList =</p>

<p class=Code><span style='color:blue'>               new</span> <span
style='color:#2B91AF'>List</span>&lt;<span style='color:#2B91AF'>AuthenticationRequest</span>&gt;();</p>

<p class=Code>               requestList.Add(adRequest);</p>

<p class=Code><span style='color:green'>        </span></p>

<p class=Code><span style='color:green'>               //
authenticating                </span></p>

<p class=Code><span style='color:#2B91AF'>               DbmPrincipal</span>
principal = </p>

<p class=Code>               <span style='color:#2B91AF'>DbmSecurityManager</span>.ServiceSoapClient.AuthenticateUser(</p>

<p class=Code>               requestList);</p>

<p class=Code>               dbMotion.Security.<span style='color:#2B91AF'>DbmSecurityManager</span>.CurrentPrincipal
= </p>

<p class=Code>               principal;</p>

<p class=Code><span style='color:blue'>               return</span> <span
style='color:blue'>true</span>;</p>

<p class=Code>        }</p>

<p class=Code><span style='color:blue'>        return</span> <span
style='color:blue'>false</span>;</p>

<p class=Code>}</p>

<p class=Code><span style='color:green'>&nbsp;</span></p>

<p class=Code><span style='color:blue'>static</span> <span style='color:blue'>void</span>
Main(<span style='color:blue'>string</span>[] args)</p>

<p class=Code>{            </p>

<p class=Code><span style='color:#2B91AF'>    Console</span>.WriteLine(<span
style='color:#A31515'>&quot;Welcome to dbMotion SDK console\n\n&quot;</span>);</p>

<p class=Code><span style='color:#2B91AF'>    Console</span>.Write(<span
style='color:#A31515'>&quot;Entet Usermae: &quot;</span>);</p>

<p class=Code><span style='color:blue'>    string</span> userName = <span
style='color:#2B91AF'>Console</span>.ReadLine();</p>

<p class=Code><span style='color:#2B91AF'>    Console</span>.Write(<span
style='color:#A31515'>&quot;Entet Password: &quot;</span>);</p>

<p class=Code><span style='color:#2B91AF'>    ConsoleColor</span> oldFore = <span
style='color:#2B91AF'>Console</span>.ForegroundColor;</p>

<p class=Code><span style='color:#2B91AF'>    Console</span>.ForegroundColor = <span
style='color:#2B91AF'>Console</span>.BackgroundColor;</p>

<p class=Code><span style='color:blue'>    string</span> password = <span
style='color:#2B91AF'>Console</span>.ReadLine();</p>

<p class=Code><span style='color:#2B91AF'>    Console</span>.ForegroundColor =
oldFore;</p>

<p class=Code>    <span style='color:blue'>if</span> (<span style='color:#2B91AF'>Authenticating</span>(userName,
password))</p>

<p class=Code>    {</p>

<p class=Code><span style='color:#2B91AF'>        Console</span>.WriteLine<span
style='color:#A31515'> {0}, you are now logged in &quot;</span>,                  
</p>

<p class=Code>        dbMotion.Security.<span style='color:#2B91AF'>DbmSecurityManager</span>.CurrentPrincipal.</p>

<p class=Code>        Identity.Name);</p>

<p class=Code>    }</p>

<p class=Code>}</p>

<span style='font-size:11.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<h2><a name="_Toc262116641">2.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Getting information from the dbMotion business layer</a></h2>

<p class=MsoCaption><span style='font-family:"Arial",sans-serif;font-weight:
normal'>The main goal of the dbMotion Business Layer is to expose aggregated
clinical data from various data repositories throughout the organization and
provide an abstraction of the details regarding how the data was collected and
harmonized.</span></p>

<h3><a name="_Toc262116642">2.2.1<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Creating a business command</a> </h3>

<h4>2.2.1.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Creating
a command parameter object</h4>

<p class=MsoBodyText>In order to execute a business layer command, we have to supply
all mandatory parameters. </p>

<p class=MsoBodyText style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><u>Note:</u></b> The list of relevant parameters can be found
in the dbMotion SDK user guide. </p>

<p class=MsoBodyText>A general use of the”DbmParameter” object :</p>

<p class=Code><span style='color:blue'>string</span> parameterName;</p>

<p class=Code><span style='color:blue'>object</span> value; <span
style='color:green'>//Value could be any type of object</span></p>

<p class=Code><a name="OLE_LINK29"><a name="OLE_LINK28"><span style='color:
#2B91AF'>DbmParameter</span> </a>CommandParameter = <span style='color:blue'>new</span>
<span style='color:#2B91AF'>DbmParameter</span>(parameterName,<span
style='color:blue'> </span>value);</a></p>

<h4><span style='color:#000081;font-weight:normal'>2.2.1.2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
style='color:#000081;font-weight:normal'>Common Business Method Instructions</span></h4>

<h5 style='margin-left:0in;text-indent:0in'>Filter expression:</h5>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>The filtering
instruction is applicable to every business method which returns multiple acts.
The filter expression is applied only on the main table (i.e. the clinical act
table, e.g. the Encounter table in “GetEncountersList” output schema).</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>The filter
expression is based on the standard ADO.NET dataset SQL filter instruction, and
has the same syntax. All the fields in the expression must be part of the main
table.</span></p>

<p class=Code><span style='color:green'>// creating the filter expression</span></p>

<p class=Code><span style='color:blue'>string </span><a name="OLE_LINK31"><a
name="OLE_LINK30">filterExpression </a>= <span style='color:#A41515'>&quot;Calc_MedicalStaffName
IN ('John Doe', 'Jane</span></a></p>

<p class=Code><span style='color:#A41515'>Doe')&quot;</span></p>

<p class=Code>+ <span style='color:#A41515'>&quot;AND Calc_Text like
'%discharge%'&quot;</span>;</p>

<p class=Code><span style='color:green'>// creating the filter instruction
parameter</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>filterParameter =
<span style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>();</p>

<p class=Code>filterParameter.ParameterName = <span style='color:#A41515'>&quot;FilterInstruction&quot;</span>;</p>

<p class=Code>filterParameter.Value = filterExpression;</p>

<h5 style='margin-left:0in;text-indent:0in'><a name="OLE_LINK33"><a
name="OLE_LINK32">Paging:</a></a></h5>

<p class=MsoBodyText>The paging instruction is applicable in every business
method which returns multiple acts, except for the Summary domain which is
intended to bring small amount of data which represents the most updated
patient’s medical state by aggregating latest clinical acts of various types.</p>

<p class=MsoBodyText>The paging instruction enables limiting the amount of data
transferred by the business to the client.</p>

<p class=MsoBodyText>Clients can provide the desired number of records to be
returned. This number will apply on the clinical act records (i.e. records in
the main table) after applying specified filter operations. </p>

<p class=MsoBodyText>Providing the page number in a method will result in
receiving the desired page after applying filter and sorting operations. The
business layer uses its cache to provide requested output in a fast manner.</p>

<p class=Code><span style='color:green'>// creating the paging instruction
parameters - we want to get the second</span></p>

<p class=Code><span style='color:green'>page</span></p>

<p class=Code><span style='color:green'>// from a result set that will be
broken up into pages of 10 records per</span></p>

<p class=Code><span style='color:green'>page</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>pageNumber = <span
style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;PageNumber&quot;</span>, 2);</p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>pageSize = <span
style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;PageSize&quot;</span>, 10);</p>

<h5 style='margin-left:0in;text-indent:0in'><a name="OLE_LINK35"><a
name="OLE_LINK34">Paging</a>:</a></h5>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>dbMotion provides
the sorting data operation. The sorting operation is applicable in every
business method which returns multiple acts. </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>Except the Summary
domain which has an overloading of the sorting parameter. The sorting is done
on one of the fields in the main table (i.e. the clinical act table, e.g. the
Encounter table in “GetEncountersList” output schema).</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>The default sorting
logic in the clinical domains is returning clinical acts sorted by the
effective time start descending. Some business methods overload this default
behavior; in such cases the custom </span>sorting logic will be depicted in the
business method’s description.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'>&nbsp;</p>

<p class=Code><span style='color:green'>// creating the sorting instruction
parameter</span></p>

<p class=Code><span style='color:blue'>string </span>sortingExpression = <span
style='color:#A41515'>&quot;Cal_MedicalStaffName DESC&quot;</span>;</p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>sortInstruction =
<span style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;SortInstruction&quot;</span>,</p>

<p class=Code>sortingExpression);</p>

<h5 style='margin-left:0in;text-indent:0in'>Time Filtering </h5>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>The time range
filter instruction provides two methods for defining the time filter, either by
a pair of</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>from and to date
values, or by a single from date, represented as a pair of time unit and values</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>parameters:</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.25in;margin-bottom:.0001pt;text-indent:-.25in;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt;font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.0pt'>From/To dates</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=Code><span style='color:green'>// creating the time range instruction
parameters</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span><span
style='color:black'>fromDate = </span><span style='color:blue'>new </span><span
style='color:#2B92B0'>DbmParameter</span><span style='color:black'>(</span><span
style='color:#A41515'>&quot;FromDttm&quot;</span><span style='color:black'>,</span></p>

<p class=Code><span style='color:#2B92B0'>                       DateTime</span><span
style='color:black'>.Now.Subtract(</span><span style='color:#2B92B0'>TimeSpan</span><span
style='color:black'>.FromDays(10)));</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span><span
style='color:black'>toDate = </span><span style='color:blue'>new </span><span
style='color:#2B92B0'>DbmParameter</span><span style='color:black'>(</span><span
style='color:#A41515'>&quot;ToDttm&quot;</span><span style='color:black'>,</span></p>

<p class=Code><span style='color:#2B92B0'>                       DateTime</span><span
style='color:black'>.Now.Subtract(</span><span style='color:#2B92B0'>TimeSpan</span><span
style='color:black'>.FromDays(5)));</span></p>

<p class=MsoListParagraph style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:.25in;margin-bottom:.0001pt;text-indent:-.25in;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt;font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.0pt'>Time units</span></p>

<p class=Code><span style='color:green'>/* Possible time units:</span></p>

<p class=Code><span style='color:green'>Year = 0,</span></p>

<p class=Code><span style='color:green'>Month = 1</span></p>

<p class=Code><span style='color:green'>Week = 2</span></p>

<p class=Code><span style='color:green'>Day = 3 </span></p>

<p class=Code><span style='color:green'>None = 4 */</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>timeUnit = <span
style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;TimeUnit&quot;</span>, 3); <span style='color:green'>//Day</span></p>

<p class=Code><span style='color:#2B92B0'>DbmParameter </span>unitAmount = <span
style='color:blue'>new </span><span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;UnitAmount&quot;</span>, 10); </p>

<p class=Code><span style='color:green'>// 10 Days</span></p>

<h3><a name="_Toc262116643">2.2.2<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Connection to the business layer</a></h3>

<p class=MsoBodyText>The dbMotion Business Client provides an ADO.NET like
experience in regards to accessing data provided by the Business Layer. <br>
The client exposes a similar object model to ADO.NET, providing a connection
class that represents the actual connection that will be established between
the client and the Business Layer.</p>

<p class=MsoBodyText>The first step to retrieving data from the Business Layer
is establishing a valid connection to a server hosting the dbMotion Business
Layer.</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=Code style='margin-right:-11.3pt'><span style='color:blue'>string </span>connectionString
= <span style='color:#A41515'>&quot;Provider=dbMotionFramework2.0;</span></p>

<p class=Code style='margin-right:-11.3pt'><span style='color:#A41515'>Uri=soap.tcp://[<a
name="OLE_LINK25"><a name="OLE_LINK24">Application server name</a>]:[port]/dbMotion/BusinessAccessService;</a></span></p>

<p class=Code style='margin-right:-11.3pt'><span style='color:#A41515'>BusinessDomainName=Conditions;
SessionTimeout=3600&quot;</span>;</p>

<p class=Code style='margin-right:-11.3pt'><span style='color:green'>&nbsp;</span></p>

<p class=Code style='margin-right:-11.3pt'><span style='color:green'>// method
#1 - manually initializing the connection</span></p>

<p class=Code style='margin-right:-11.3pt'><span style='color:#2B92B0'>DbmConnection
</span>conn = <span style='color:blue'>new </span>dbMotion.DbmSystem.BAC.<span
style='color:#2B92B0'>DbmConnection</span>();</p>

<p class=Code style='margin-right:-11.3pt'>conn.BusinessDomainName = <span
style='color:#A41515'>&quot;</span><span style='font-size:11.0pt;font-family:
"Arial",sans-serif'> </span><span style='color:#A41515'>BusinessDomainName &quot;</span>;</p>

<p class=Code style='margin-right:-11.3pt'>conn.Uri = <span style='color:#A41515'>&quot;soap.tcp://[Application
server name]:[port]&quot;</span>;</p>

<p class=Code style='margin-right:-11.3pt'><span style='color:green'>&nbsp;</span></p>

<p class=Code style='margin-right:-11.3pt'><span style='color:green'>// method
#2 - initializing the connection using a connection string</span></p>

<p class=Code style='margin-right:-11.3pt'>conn = <span style='color:blue'>new </span><span
style='color:#2B92B0'>DbmConnection</span>(connectionString);</p>

<p class=Code style='margin-right:-11.3pt'><a name="OLE_LINK23"><a
name="OLE_LINK22"><span style='color:green'>// opening the connection</span></a></a></p>

<p class=Code style='margin-right:-11.3pt'>conn.Open();</p>

<p class=Code style='margin-right:-11.3pt'><span style='color:green'>/* <a
name="OLE_LINK27"><a name="OLE_LINK26">Executing a command </a>*/</a></span></p>

<p class=Code style='margin-right:-11.3pt'>conn.Close();<span style='color:
green'>// closing the connection</span></p>

<h3><a name="_Toc262116644">2.2.3<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>dbMotion business Command</a></h3>

<h4>2.2.3.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Set
command object</h4>

<p class=MsoBodyText>Before we can execute a command we need to define a
command object.</p>

<p class=Code>    <span style='color:blue'>string</span> commandString = <span
style='color:#A41515'>&quot; AspectName::Execute MethodName&quot;</span>;</p>

<p class=Code>    <span style='color:#2B92B0'>DbmCommand</span> cmd = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>DbmCommand</span>(commandString);</p>

<p class=MsoBodyText>The command object must get all mandatory parameters in
order to run.</p>

<p class=Code>    cmd.CommandParameters.Add(parametrObject);</p>

<h4>2.2.3.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span>Executing
a command</h4>

<p class=MsoBodyText>To execute a command we need to add to the “DbmConnection”
object all relevant information (such as parameters etc), like so:</p>

<p class=Code><span style='color:green'>///////////////////////////////Open a
connection /////////////////////////// </span></p>

<p class=Code><span style='color:blue'>string</span> BusinessAccessService = </p>

<p class=Code>        <span style='color:#A41515'>&quot;net.tcp://[ServerName]:[Port]/dbMotion/BusinessAccessService&quot;</span>;</p>

<p class=Code><span style='color:blue'>string</span> BDname = <span
style='color:#A41515'>&quot;System&quot;</span>;</p>

<p class=Code><span style='color:blue'>int</span> timeout = 3600;     </p>

<p class=Code><span style='color:blue'>string</span> connectionString = <span
style='color:blue'>string</span>.Format(</p>

<p class=Code>   <span style='color:#A41515'>&quot;Provider=dbMotionFramework2.0;
Uri={0}; BusinessDomainName={1}; </span></p>

<p class=Code><span style='color:#A41515'>    SessionTimeout={2}&quot;</span>,BusinessAccessService,
BDname, timeout.ToString());</p>

<p class=Code>     <span style='color:#2B92B0'>DbmConnection</span> conn = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>DbmConnection</span>(connectionString);</p>

<p class=Code><span style='color:green'>///////////////////////////////Create a
parameter //////////////////////////</span></p>

<p class=Code><span style='color:#2B92B0'>PersonSearchCriteria</span> SQ = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>PersonIdentification</span>.PersonSearchCriteria();</p>

<p class=Code>SQ.AddIdentifier<span style='color:#A41515'>(&quot;FNAME&quot;,
&quot;Patient&quot;);</span></p>

<p class=Code>SQ.AddIdentifier(<span style='color:#A41515'>&quot;GNAME&quot;,
&quot;One&quot;</span>);</p>

<p class=Code>SQ.AddMatchCondition(<span style='color:#A41515'>&quot;MRN_SysSearch&quot;,
&quot;False&quot;</span>);</p>

<p class=Code><span style='color:#2B92B0'>DbmParameter</span> SearchQuery = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;SearchQuery&quot;,</span> SQ);</p>

<p class=Code><span style='color:green'>///////////////////////////////Set a
command ///////////////////////////////</span></p>

<p class=Code>    <span style='color:blue'>string</span> commandString = <span
style='color:#A41515'>&quot;PatientEntrance::Execute PatientSearchAsDS&quot;</span>;</p>

<p class=Code>    <span style='color:green'>// AspectName::</span><span
style='color:#A41515'> </span><span style='color:green'>Execute</span> <span
style='color:green'>MethodName</span>     </p>

<p class=Code>    <span style='color:#2B92B0'>DbmCommand</span> cmd = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>DbmCommand</span>(commandString);</p>

<p class=Code>    cmd.CommandParameters.Add(SearchQuery);</p>

<p class=Code><span style='color:green'>///////////////////////////////Execute
Command /////////////////////////////</span></p>

<p class=Code>     cmd.DbmConnection = conn;</p>

<p class=Code>     <span style='color:#2B92B0'>DataSet</span> ds = <span
style='color:blue'>new </span>DataSet();</p>

<p class=Code>     <span style='color:green'>// opening the connection</span>    
</p>

<p class=Code>     conn.Open();</p>

<p class=Code><span style='color:green'>     // Execute Command</span></p>

<p class=Code>     ds = cmd.ExecuteDataSet();</p>

<p class=Code>     <span style='color:green'>// closing the connection</span></p>

<p class=Code>     conn.Close();</p>

<h3><a name="_Toc262116645">2.2.4<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Exercise</a></h3>

<p class=MsoBodyText>Create a simple client that authenticates to the dbMotion
system and search for a patient using his/hers MRN ID (Refer the dbMotion SDK
user guide for more information).</p>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>The only differents <span style='font-family:"Tahoma",sans-serif'>between
the examples above is the parameter list we are using:</span></p>

<p class=Code><span style='color:green'>// Exercise 2.2.4</span></p>

<p class=Code><span style='color:#2B92B0'>PersonSearchCriteria</span> SQ = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>PersonIdentification</span>.PersonSearchCriteria();</p>

<p class=Code>string MRN_SYS = <span style='color:#A31515'>&quot;2.16.840.1.113883.3.57.1.3.11.13.1.8.2&quot;</span>;</p>

<p class=Code>string MRN_ID = <span style='color:#A31515'>&quot;167580070&quot;</span>;</p>

<p class=Code>SQ.AddIdentifier(<span style='color:#A41515'>&quot;MRN_ID&quot;, </span>MRN_ID);</p>

<p class=Code>SQ.AddIdentifier(<span style='color:#A41515'>&quot;MRN_SYS&quot;,
</span>MRN_SYS);</p>

<p class=Code>SQ.AddMatchCondition(<span style='color:#A41515'>&quot;MRN_SysSearch&quot;,
&quot;True&quot;</span>);</p>

<p class=Code><span style='color:#2B92B0'>DbmParameter</span> SearchQuery = <span
style='color:blue'>new</span> <span style='color:#2B92B0'>DbmParameter</span>(<span
style='color:#A41515'>&quot;SearchQuery&quot;,</span> SQ);</p>

<span style='font-size:11.0pt;font-family:"Arial",sans-serif'><br clear=all
style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<h2><a name="OLE_LINK37"><a name="OLE_LINK36"><a name="_Toc262116646">2.3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Using the VIA
client</a></a></a></h2>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:10.0pt'>The dbMotion VIA
client provides developers with the ability to perform person identification </span></p>

<p class=MsoBodyText>operations through dbMotion VIA Service.</p>

<p class=MsoBodyText>The majority of business methods are requiring a
“PersonIdentity” object, we can use the VIA client to search for patient and
receive the object needed.</p>

<h3><a name="OLE_LINK39"><a name="OLE_LINK38"><a name="_Toc262116647">2.3.1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span>Getting started</a> </a></a></h3>

<p class=MsoBodyText>First we need to add some references to our project:</p>

<p class=MsoBodyText align=center style='text-align:center'><img width=222
height=174 id="Picture 1" src="dbMotion%20Instructor%20Guide.fld/image014.png"></p>

<p class=MsoCaption align=center style='text-align:center'><a
name="_Toc262113701">Figure </a>13 - Additional references</p>

<p class=MsoBodyText>To our source will have to add the following:</p>

<p class=Code><span style='color:blue'>using</span> dbMotion.DbmSystem;</p>

<p class=Code><span style='color:green'>// import the Person Identification
relevant namespaces</span></p>

<p class=Code><span style='color:blue'>using</span>
dbMotion.PersonIdentification; </p>

<p class=Code><span style='color:green'>// import VIA Metadata namespaces</span></p>

<p class=Code><span style='color:blue'>using</span>
dbMotion.PersonIdentification.Client; </p>

<h3><a name="_Toc262116648">2.3.2<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Searching for patients</a></h3>

<h4 style='margin-bottom:0in;margin-bottom:.0001pt;line-height:normal'><span
style='font-size:10.0pt'>2.3.2.1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt;color:#000081'>Demographic s</span><span
style='font-size:10.0pt;color:#000081;font-weight:normal'>earch</span></h4>

<p class=MsoBodyText>&nbsp;</p>

<p class=MsoBodyText>One of the main features of VIA Service is to enable a
client to search for person identifiers using the basic information known about
that person: name, gender, address, etc. </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>First, will have to create a VIA client
instance:</span></p>

<p class=Code><span style='color:blue'>string</span> VIA_Service_URI = <span
style='color:#A31515'>&quot;soap.tcp://[ServerName]:[Port]/IdentificationService&quot;</span>;</p>

<p class=Code><span style='color:green'>// Create an instance of VIA Client -
giving the service URI</span></p>

<p class=Code><span style='color:#2B91AF'>IdentificationServicesClient</span>
client = <span style='color:blue'>new</span> <span style='color:#2B91AF'>IdentificationServicesClient</span>(VIA_Service_URI);                       
</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>Second, we have to create a search query
with the patient’s demographics:</span></p>

<p class=Code><span style='color:green'>// Prepare Search input parameter - Search
Criteria</span></p>

<p class=Code><span style='color:#2B91AF'>PersonSearchCriteria</span>
searchCriteria = <span style='color:blue'>new</span> <span style='color:#2B91AF'>PersonSearchCriteria</span>();</p>

<p class=Code><span style='color:green'>// Add familyName and givenName to
Search Criteria identifiers</span></p>

<p class=Code>searchCriteria.AddIdentifier(<span style='color:#A31515'>&quot;FNAME&quot;</span>,
<span style='color:#A31515'>&quot;PatientOne&quot;</span>);</p>

<p class=Code>searchCriteria.AddIdentifier(<span style='color:#A31515'>&quot;GNAME&quot;</span>,
<span style='color:#A31515'>&quot;Releasea&quot;</span>);</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>The final step is running the request
and saving the information:</span></p>

<p class=Code><span style='color:green'>// Execute search through client and
keep the result</span></p>

<p class=Code><span style='color:#2B91AF'>VirtualPersonIndexCollection</span>
searchResult = </p>

<p class=Code>        client.SearchPerson(searchCriteria);</p>

<h4 style='margin-bottom:0in;margin-bottom:.0001pt;line-height:normal'><span
style='font-size:10.0pt'>2.3.2.2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt;color:#000081'>Match a Person Using
its Unique Identifier</span></h4>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>When we need to find a specific patient
and the results must be Injective, we will use this method:</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=Code><span style='color:green'>//Prepare Match input parameter -
person index </span></p>

<p class=Code><span style='color:green'>//sourceSystem – The relevant system
the patient is on</span></p>

<p class=Code><span style='color:green'>//sourceIndex – The Injective id of the
patient</span></p>

<p class=Code><span style='color:green'>//MPI_Provider_Name – MPI provider name
(i.e. UPMC, RHIO, etc)</span></p>

<p class=Code><span style='color:#2B91AF'>Index</span> knownIndex = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>Index</span>(<span
style='color:#A31515'>&quot;2.16.840.1.113883.3.57.1.3.11.13.1.8.2&quot;</span>,
<span style='color:#A31515'>&quot;167580070&quot;</span>, <span
style='color:#A31515'>&quot;UPMC&quot;</span>);</p>

<p class=Code><span style='color:green'>// Execute match through client and
keep the result</span></p>

<p class=Code><span style='color:#2B91AF'>PersonIndex</span> matchResult =
client.MatchIndex(knownIndex);</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt;font-family:"Courier New",serif;
color:black'>&nbsp;</span></p>

<h3><a name="_Toc262116649">2.3.3<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span>Exercise</a></h3>

<p class=MsoListParagraph style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:31.5pt;margin-bottom:.0001pt;text-indent:-.25in;line-height:
normal'><span style='font-size:10.0pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt'>Search for a patient using the VIA
client (demographic search).</span></p>

<p class=MsoListParagraph style='margin-top:0in;margin-right:0in;margin-bottom:
0in;margin-left:31.5pt;margin-bottom:.0001pt;text-indent:-.25in;line-height:
normal'><span style='font-size:10.0pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt'>Save the patient index and use it
to retrieve the patient`s </span><span style='font-size:10.0pt;font-family:
"Tahoma",sans-serif'>substance administration </span><span style='font-size:
10.0pt'>information in the last three years.</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
normal'><span style='font-size:10.0pt'>&nbsp;</span></p>

<p class=Code><span style='color:green'>// Exercise 2.3.3</span></p>

<p class=Code><span style='color:blue'>static</span> <span style='color:blue'>void</span>
Main(<span style='color:blue'>string</span>[] args)</p>

<p class=Code>{</p>

<p class=Code><span style='color:#2B91AF'>PersonIdentity</span> PI = <span
style='color:blue'>null</span>;</p>

<p class=Code><span style='color:blue'>string </span>VIA_Service_URI = </p>

<p class=Code>        <span style='color:#A31515'>&quot;soap.tcp://<a
name="OLE_LINK43"><a name="OLE_LINK42">[ApplicationServerName]:[Port]</a>/IdentificationService&quot;</a></span>;</p>

<p class=Code><span style='color:green'>// Create an instance of VIA Client -
giving the service URI</span></p>

<p class=Code><span style='color:#2B91AF'>IdentificationServicesClient</span>
client = <span style='color:blue'>new</span> <span style='color:#2B91AF'>IdentificationServicesClient</span>(VIA_Service_URI);</p>

<p class=Code><span style='color:green'>// Prepare Search input parameter -
Search Criteria</span></p>

<p class=Code><span style='color:#2B91AF'>PersonSearchCriteria</span>
searchCriteria = <span style='color:blue'>new</span> <span style='color:#2B91AF'>PersonSearchCriteria</span>();</p>

<p class=Code><span style='color:green'>// Add familyName and givenName to
Search Criteria identifiers</span></p>

<p class=Code>searchCriteria.AddIdentifier(<span style='color:#A31515'>&quot;FNAME&quot;</span>,
<span style='color:#A31515'>&quot;PatientOne&quot;</span>);</p>

<p class=Code>searchCriteria.AddIdentifier(<span style='color:#A31515'>&quot;GNAME&quot;</span>,
<span style='color:#A31515'>&quot;Releasea&quot;</span>);</p>

<p class=Code><span style='color:blue'>try</span></p>

<p class=Code>{</p>

<p class=Code><span style='color:green'>// Execute search through client and
keep the result</span></p>

<p class=Code><span style='color:#2B91AF'>VirtualPersonIndexCollection</span>
searchResult = client.SearchPerson(searchCriteria);</p>

<p class=Code>PI = searchResult[0].ReorganizeToPersonIdentity();</p>

<p class=Code>}</p>

<p class=Code><span style='color:blue'>catch</span> (<span style='color:#2B91AF'>PersonIdentificationException</span>
ex){</p>

<p class=Code>throw ex; <span style='color:green'>// Catch and handle the
exception here</span>}</p>

<p class=Code><span style='color:blue'>if</span> (PI != <span style='color:
blue'>null</span>)</p>

<p class=Code>{</p>

<p class=Code>Authenticating();<span style='color:green'>// From Exercise 2.1.1
</span></p>

<p class=Code><span style='color:green'>///////////////////////////////Open a
connection////////////////////////////</span></p>

<p class=Code>string BusinessAccessService = </p>

<p class=Code><span style='color:#A31515'>&quot;net.tcp://[ApplicationServerName]:[Port]/dbMotion/BusinessAccessService&quot;</span>;</p>

<p class=Code>string BDname = <span style='color:#A31515'>&quot;Medications&quot;</span>;</p>

<p class=Code>int timeout = 3600;</p>

<p class=Code>string connectionString =
string.Format(                                   <span style='color:#A31515'>&quot;Provider=dbMotionFramework2.0;
Uri={0}; BusinessDomainName={1}; SessionTimeout={2}&quot;</span>,BusinessAccessService,
BDname, timeout.ToString());</p>

<p class=Code><span style='color:#2B91AF'>DbmConnection</span> conn = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>DbmConnection</span>(connectionString);  
</p>

<p class=Code><span style='color:green'>//////////////////////////////Creating
parameters //////////////////////////</span></p>

<p class=Code><span style='color:#2B91AF'>DbmParameter</span> PersonIdentity = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>DbmParameter</span>(<span
style='color:#A31515'>&quot;PersonIdentity&quot;</span>, PI);</p>

<p class=Code><span style='color:#2B91AF'>DbmParameter</span> timeUnit = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>DbmParameter</span>(<span
style='color:#A31515'>&quot;TimeUnit&quot;</span>, (<span style='color:blue'>byte</span>)0);
</p>

<p class=Code><span style='color:#2B91AF'>DbmParameter</span> unitAmount = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>DbmParameter</span>(<span
style='color:#A31515'>&quot;UnitAmount&quot;</span>, 3);                </p>

<p class=Code><span style='color:green'>///////////////////////////////Set a
command ///////////////////////////////       </span></p>

<p class=Code>string commandString = <span style='color:#A31515'>&quot;Medication::Execute
GetMedicationsList&quot;</span>;</p>

<p class=Code><span style='color:#2B91AF'>DbmCommand</span> cmd = <span
style='color:blue'>new</span> <span style='color:#2B91AF'>DbmCommand</span>(commandString);</p>

<p class=Code>cmd.CommandParameters.Add(PersonIdentity);</p>

<p class=Code>cmd.CommandParameters.Add(timeUnit);</p>

<p class=Code>cmd.CommandParameters.Add(unitAmount);</p>

<p class=Code><span style='color:green'>///////////////////////////////Execute
Command /////////////////////////////       </span></p>

<p class=Code><span style='color:blue'>try</span></p>

<p class=Code>{</p>

<p class=Code>cmd.DbmConnection = conn;</p>

<p class=Code><span style='color:#2B91AF'>DataSet</span> ds = new <span
style='color:#2B91AF'>DataSet</span>();</p>

<p class=Code><span style='color:green'>// opening the connection            </span></p>

<p class=Code>conn.Open();</p>

<p class=Code>ds = cmd.ExecuteDataSet();</p>

<p class=Code><span style='color:green'>// closing the connection</span></p>

<p class=Code>conn.Close();</p>

<p class=Code>ds.WriteXml(<span style='color:#A31515'>“output.xml&quot;</span>);
<span style='color:green'>//Save the output in an XML
format                      </span></p>

<p class=Code>}</p>

<p class=Code><span style='color:blue'>catch</span> (<span style='color:#2B91AF'>Exception</span>
ex)</p>

<p class=Code>{</p>

<p class=Code>throw ex; <span style='color:green'>// Catch and handle the
exception here</span></p>

<p class=Code>}</p>

<p class=Code>}</p>

<p class=Code>}</p>

<p class=Code><span style='color:#2B91AF'>Console</span>.WriteLine(<span
style='color:#A31515'>&quot;Press any key to continue...&quot;</span>);</p>

<p class=Code><span style='color:#2B91AF'>Console</span>.ReadKey();</p>

<p class=Code>}</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
